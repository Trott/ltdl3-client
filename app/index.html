<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <title>LTDL3 Client</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->

        <!-- build:css styles/main.css -->
        <link rel="stylesheet" href="styles/main.css">
        <!-- endbuild-->

        <!-- Place your HTML imports here -->
        <script src="bower_components/jquery/dist/jquery.min.js"></script>
        <script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
    </head>
    <body>
                    <a href="https://github.com/Trott/ltdl3-client"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/a6677b08c955af8400f44c6298f40e7d19cc5b2d/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677261795f3664366436642e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png"></a>
        <div class="container">
            <div class="jumbotron">
                <h4>LTDL3 Search Builder Prototype</h4>
                <form role="form">
                    <div id="ltdl-search-builder"></div>
                    <div class="pull-right">
                        <button type="submit" class="btn btn-default">Search <span class="glyphicon glyphicon-search"></span></button>
                    </div>
                </form>
            </div>
        </div>
        <div id="footer">
            <div class="container text-muted text-center small">
                <p>Copyright 2014 Regents of the University of California</p>
                <p><a href="http://glyphicons.com/">Glyphicons</a> are used on this page.</p>
            </div>
        </div>
        <script>
            // TODO: Inline script. No no no no no. (Well, yes yes yes after a build process perhaps.)
            var filterWhatCallback = function () {
                $(this).parents('.ltdl-search-builder-component').find('button.ltdl-filter-what').html($(this).text() + ' <span class="caret"></span>');
            };

            var filterWhatToSearchBoxCallback = function () {
                // TODO:Yeah, we need to improve the way we navigate to the desired element here...
                $(this).parent().parent().parent().parent().parent().parent().find('.ltdl-search-box').val($(this).text()).focus();
                $(this).parent().parent().parent().parent().parent().find('button.ltdl-filter-what').html($(this).parent().parent().parent().find('.hoist-to-button').text() + ' <span class="caret"></span>');
            }

            var filterPhraseCallback = function () {
                $(this).parent().parent().parent().find('.ltdl-filter-phrase').html($(this).text() + ' <span class="caret"></span>');
            };

            // TODO: Big long DOM string, no no no.
            // TODO: classes sometimes prepended with ltdl- but not always. Make it always.
            var addSearchBuilderComponent = function () {
                var newSearchBuilderComponent = $('<div class="form-group ltdl-search-builder-component">' +
                    '<div class="input-group">' +
                        '<div class="input-group-btn">' +
                            '<button type="button" class="btn btn-default dropdown-toggle ltdl-filter-what" data-toggle="dropdown">' +
                                'Everywhere <span class="caret"></span>' +
                            '</button>' +
                            '<ul class="dropdown-menu ltdl-filter-what" role="menu">' +
                                '<li><a class="show-in-button" href="#">Everywhere</a></li>' +
                                '<li><a class="show-in-button" href="#">Title</a></li>' +
                                '<li><a class="show-in-button" href="#">Person</a></li>' +
                                '<li><a class="show-in-button" href="#">Organization</a></li>' +
                                '<li class="dropdown-submenu">' +
                                    '<a class="hoist-to-button" href="#">Type</a>' +
                                    '<ul class="dropdown-menu ltdl-filter-what-phrase">' +
                                        '<li><a class="show-in-search-box" href="#">Letter</a></li>' +
                                        '<li><a class="show-in-search-box" href="#">Email</a></li>' +
                                        '<li><a class="show-in-search-box" href="#">Report</a></li>' +
                                        '<li><a class="show-in-search-box" href="#">Ad</a></li>' +
                                        '<li><a class="show-in-search-box" href="#">Video</a></li>' +
                                        '<li><a class="show-in-search-box" href="#">Memo</a></li>' +
                                        '<li><a class="show-in-search-box" href="#">Newsletter</a></li>' +
                                        '<li><a class="show-in-search-box" href="#">Journal</a></li>' +
                                        '<li><a class="show-in-search-box" href="#">Invoice</a></li>' +
                                        '<li><a class="show-in-search-box" href="#">Financial</a></li>' +
                                        '<li><a class="show-in-search-box" href="#">Agenda</a></li>' +
                                        '<li><a class="show-in-search-box" href="#">Form</a></li>' +
                                        '<li><a class="show-in-search-box" href="#">Article</a></li>' +
                                        '<li><a class="show-in-search-box" href="#">Audio</a></li>' +
                                        '<li><a class="show-in-search-box" href="#">Graphics</a></li>' +
                                        '<li><a href="#">Other</a></li>' +
                                    '</ul>' +
                                '</li>' +
                                '<li class="dropdown-submenu">' +
                                    '<a class="hoist-to-button" href="#">Brand Name</a>' +
                                    '<ul class="dropdown-menu ltdl-filter-what-phrase">' +
                                        '<li><a class="show-in-search-box" href="#">Camel</a></li>' +
                                        '<li><a class="show-in-search-box" href="#">Marlboro</a></li>' +
                                        '<li><a class="show-in-search-box" href="#">Virginia Slims</a></li>' +
                                        '<li><a class="show-in-search-box" href="#">Skoal</a></li>' +
                                        '<li><a class="show-in-search-box" href="#">Garcia Y Vega</a></li>' +
                                        '<li><a class="show-in-search-box" href="#">More</a></li>' +
                                        '<li><a class="show-in-search-box" href="#">Winston</a></li>' +
                                        '<li><a class="show-in-search-box" href="#">Other</a></li>' +
                                    '</ul>' +
                                '</li>' +
                                '<li><a class="show-in-button" href="#">Bates Number</a></li>' +
                                '<li><a class="show-in-button" href="#">ID Number</a></li>' +
                                '<li class="divider"></li>' +
                                '<li class="dropdown-submenu">' +
                                    '<a href="#">More</a>' +
                                    '<ul class="dropdown-menu">' +
                                        '<li><a class="show-in-button" href="#">Text</a></li>' +
                                        '<li><a class="show-in-button" href="#">Metadata</a></li>' +
                                        '<li><a class="show-in-button" href="#">Keyword</a></li>' +
                                        '<li><a class="show-in-button" href="#">Notes</a></li>' +
                                    '</ul>' +
                                '</li>' +
                            '</ul>' +
                        '</div>' +
                        '<div class="input-group-btn">' +
                            '<button type="button" class="btn btn-default dropdown-toggle ltdl-filter-phrase" data-toggle="dropdown">' +
                                'for any of the words <span class="caret"></span>' +
                            '</button>' +
                            '<ul class="dropdown-menu" role="menu">' +
                                '<li><a href="#">for any of the words</a></li>' +
                                '<li><a href="#">for all of the words</a></li>' +
                                '<li><a href="#">for the exact phrase</a></li>' +
                            '</ul>' +
                        '</div>' +
                        '<input class="form-control ltdl-search-box" type="text" placeholder="Tip: use (*) or (?) to find word variants like legislat* and wom?n">' +
                        '<div class="input-group-btn">' +
                            '<button type="button" class="btn btn-default ltdl-search-add"><span class="glyphicon glyphicon-plus"></span></button>' +
                        '</div>' +
                    '</div>' +
                '</div>');

                $(newSearchBuilderComponent).find('.show-in-button').on('click', filterWhatCallback);
                $(newSearchBuilderComponent).find('.ltdl-filter-what ~ ul .show-in-search-box').on('click', filterWhatToSearchBoxCallback);
                $(newSearchBuilderComponent).find('.ltdl-filter-phrase ~ ul > li > a').on('click', filterPhraseCallback);

                $(newSearchBuilderComponent).find('button.ltdl-search-add').on('click', addSearchBuilderComponent);

                $('#ltdl-search-builder').append(newSearchBuilderComponent);
            };

            $('document').ready(addSearchBuilderComponent());

            // TODO: other, +/-, AND/OR/NOT
        </script>
    </body>
</html>
